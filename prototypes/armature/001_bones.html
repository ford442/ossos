<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title></title></head>
<style>canvas{ display:block; } body, html { padding:0px; margin:0px; width:100%; height:100%; }</style>
<body><script type="module">
//#region IMPORTS
import useThreeWebGL2, { useDarkScene, useVisualDebug } from '../_lib/useThreeWebGL2.js';
import Util                 from '../_lib/misc/Util.js';
import { Armature, Bone }   from '../../src/index';
import { vec3, quat }       from 'gl-matrix';
//#endregion

//#region MAIN
let App = useDarkScene( useThreeWebGL2() );
let Debug;

window.addEventListener( 'load', async _=>{
    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    // Setup
    App.sphericalLook( 0, 20, 6 );
    Debug = await useVisualDebug( App );

    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    // Create Armature / Skeleton
    const arm = new Armature();
    const b0  = arm.addBone( { name:'root' });
    const b1  = arm.addBone( { parent: 'root', pos:[0,0.4,0] } );
    const b2  = arm.addBone( { parent: 1,      pos:[0,0.4,0] } );
    const b3  = arm.addBone( { parent: b2,     pos:[0,0.4,0] } );
    const b4  = arm.addBone( new Bone( { parent: b3, pos:[0,0.4,0] } ) )

    arm.bind( 0.4 );

    // Modify bones in local space
    quat.setAxisAngle( b0.local.rot, [1,0,0], 22.5 * Math.PI / 180 );
    quat.setAxisAngle( b1.local.rot, [1,0,0], 45 * Math.PI / 180 );
    quat.setAxisAngle( b2.local.rot, [1,0,0], 45 * Math.PI / 180 );
    quat.setAxisAngle( b3.local.rot, [1,0,0], 45 * Math.PI / 180 );
    quat.setAxisAngle( b4.local.rot, [1,0,0], -90 * Math.PI / 180 );
    arm.updateWorld();

    // View Bones
    Util.debugBones( arm.bones, Debug );
    
    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    App.renderLoop();
});
//#endregion

</script></body></html>